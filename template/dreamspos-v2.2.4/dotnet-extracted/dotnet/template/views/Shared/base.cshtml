@{
    var html_attributes = (ViewData["HTMLAttributes"] as string) ?? "";
    var html_class = (ViewData["HTMLClass"] as string) ?? "";

    // Get the current page name from the request path
    var path = Context?.Request?.Path.Value ?? string.Empty;
    var fileName = System.IO.Path.GetFileName(path);
    var pageName = string.IsNullOrEmpty(fileName) ? "index" : System.IO.Path.GetFileNameWithoutExtension(fileName);
    var route = pageName.ToLowerInvariant();

    // Determine the body class based on the page route
    var body_class = route switch
    {
        "layout-horizontal" => "menu-horizontal",
        "layout-hovered" => "mini-sidebar expand-menu",
        "layout-boxed" => "mini-sidebar layout-box-mode",
        "layout-rtl" => "layout-mode-rtl",

        "pos" or "pos-2" or "pos-3" or "pos-4" or "pos-5" => "pos-page",

        _ => ""
    };

    // Define pages excluded from additional body styling (if needed later)
    var excludedPages = new HashSet<string> {
        "under-maintenance", "coming-soon", "error-404", "error-500",
        "two-step-verification-3", "two-step-verification-2", "two-step-verification",
        "email-verification-3", "email-verification-2", "email-verification",
        "reset-password-3", "reset-password-2", "reset-password",
        "forgot-password-3", "forgot-password-2", "forgot-password",
        "register-3", "register-2", "register",
        "signin-3", "signin-2", "signin",
        "success", "success-2", "success-3",
        "layout-horizontal", "layout-hovered", "layout-boxed", "layout-rtl",
        "pos", "pos-2", "pos-3", "pos-4", "pos-5"
    };

    // You can adjust classes if necessary based on excluded pages
    // (currently not modifying since body_class is already set correctly)

    ViewData["BodyClass"] = body_class;
}

<!DOCTYPE html>
<html lang="en" class="@html_class" @Html.Raw(html_attributes)>
<head>
    @{
        var pathBase = Context?.Request?.PathBase.Value ?? string.Empty;
    }
    <meta name="base-path" content="@pathBase" />
    @await Html.PartialAsync("~/Views/Shared/Partials/_TitleMeta.cshtml")
    @RenderSection("styles", false)
    @await Html.PartialAsync("~/Views/Shared/Partials/_HeadCss.cshtml")
</head>

<body class="@body_class">

    @await Html.PartialAsync("~/Views/Shared/Partials/main-wrapper.cshtml")
    @await Html.PartialAsync("~/Views/Shared/Partials/_Topbar.cshtml")
    @await Html.PartialAsync("~/Views/Shared/Partials/_Sidenav.cshtml")
    @await Html.PartialAsync("~/Views/Shared/Partials/horizontal-sidebar.cshtml")
    @await Html.PartialAsync("~/Views/Shared/Partials/twocolumn-sidebar.cshtml")

    @RenderBody()

    @await Html.PartialAsync("~/Views/Shared/Partials/modal-popup.cshtml")
    @await Html.PartialAsync("~/Views/Shared/Partials/_FooterScripts.cshtml")
    @await Html.PartialAsync("~/Views/Shared/Partials/theme-settings.cshtml")
    @RenderSection("scripts", required: false)
</body>
</html>
